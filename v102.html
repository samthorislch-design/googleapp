<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="pageTitle">KeyHome æˆ¿äº§ç®¡ç†ç³»ç»Ÿ</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- 1. KeyHome ç°ä»£åŒ–ä¸»é¢˜ CSS --- */
        :root {
            --keyhome-primary: #0056b3;    /* æ·±è“è‰² (ä¸»è‰²è°ƒ) */
            --keyhome-accent: #28a745;     /* ç»¿è‰² (æˆåŠŸ/æ”¶å…¥) */
            --keyhome-danger: #dc3545;     /* çº¢è‰² (æ”¯å‡º/é€¾æœŸ) */
            --keyhome-warning: #ffc107;    /* è­¦å‘Šé»„è‰² (å¾…å¤„ç†) */
            --keyhome-bg: #f8f9fa;         /* æµ…ç°èƒŒæ™¯ */
            --keyhome-secondary-bg: #e9ecef; /* æ¬¡è¦èƒŒæ™¯ */
            --keyhome-card-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.05); /* æŸ”å’Œé˜´å½± */
            --keyhome-font: #343a40;       /* æ·±ç°å­—ä½“ */
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--keyhome-bg);
            color: var(--keyhome-font);
        }

        .card {
            border: none;
            border-radius: 0.75rem;
            box-shadow: var(--keyhome-card-shadow);
        }

        .card-header {
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            background-color: white;
            font-weight: 600;
            color: var(--keyhome-font);
            padding: 1rem 1.5rem;
        }
        
        /* ä¿®å¤ï¼šç¡®ä¿è´¢åŠ¡KPIå¡ç‰‡é¢œè‰²ä¸ºå®è‰² */
        .finance-kpi-card-income { background-color: var(--keyhome-accent) !important; color: white !important; }
        .finance-kpi-card-expense { background-color: var(--keyhome-danger) !important; color: white !important; }
        .finance-kpi-card-netflow { background-color: var(--keyhome-primary) !important; color: white !important; }
        .finance-kpi-card-income .card-title,
        .finance-kpi-card-expense .card-title,
        .finance-kpi-card-netflow .card-title {
            color: white !important;
        }

        /* å¯¼èˆªæ  */
        .nav-pills .nav-link {
            color: var(--keyhome-primary);
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            transition: background-color 0.2s;
        }

        .nav-pills .nav-link.active,
        .nav-pills .nav-link:hover {
            background-color: var(--keyhome-primary);
            color: white;
        }

        /* æ‘˜è¦å¡ç‰‡ */
        .summary-card-icon {
            font-size: 2.5rem;
            opacity: 0.6;
        }
        .summary-card-value {
            font-size: 2.2rem;
            font-weight: 700;
            line-height: 1;
        }
        .trend-indicator {
            font-size: 0.9rem;
            font-weight: 600;
        }
        .text-up { color: var(--keyhome-accent); }
        .text-down { color: var(--keyhome-danger); }

        /* ç‰©ä¸šå¡ç‰‡åˆ—è¡¨æ ·å¼ */
        .property-list-card {
            cursor: pointer;
            border-left: 5px solid transparent;
            transition: all 0.2s ease-in-out;
        }
        .property-list-card.rented { border-left-color: var(--keyhome-accent); }
        .property-list-card.renovation { border-left-color: var(--keyhome-warning); }
        .property-list-card.preparing { border-left-color: var(--keyhome-primary); }
        
        .property-list-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--keyhome-card-shadow);
        }
        .card-title-status {
            font-size: 1.1rem;
            font-weight: 600;
        }
        .list-group-item {
            border-color: #eee;
        }
        /* è¾…åŠ©é¢œè‰²ç±» */
        .bg-subtle-primary { background-color: rgba(0, 86, 179, 0.1); }
        .bg-subtle-accent { background-color: rgba(40, 167, 69, 0.1); }
        .bg-subtle-danger { background-color: rgba(220, 53, 69, 0.1); }
        .bg-subtle-warning { background-color: rgba(255, 193, 7, 0.1); }
        
        /* ç™»å½•é¡µé¢ç‰¹å®šæ ·å¼ */
        #login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: var(--keyhome-primary);
        }
        .login-box {
            background: white;
            padding: 30px;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 400px;
        }
        .login-logo {
            height: 80px; 
            width: auto;
            margin-bottom: 20px;
            object-fit: contain;
        }
        .sortable-th {
            cursor: pointer;
            position: relative;
        }
        .sortable-th:hover {
            color: var(--keyhome-primary);
        }
        .sort-icon {
            margin-left: 5px;
            font-size: 0.7em;
            color: #ccc;
        }
        .sortable-th.sorted .sort-icon {
            color: var(--keyhome-primary);
        }
    </style>
</head>
<body>

    <div id="login-container">
        <div class="login-box">
            <div class="text-end mb-3">
                <button class="btn btn-sm btn-outline-secondary me-2" onclick="setLanguage('zh')">ä¸­æ–‡</button>
                <button class="btn btn-sm btn-outline-secondary" onclick="setLanguage('en')">English</button>
            </div>
            <div class="text-center">
                <img src="logokeyhome.jpeg" alt="KeyHome Logo" class="login-logo">
                <h4 class="mb-4 text-primary" data-i18n="loginTitle">ç³»ç»Ÿç™»å½•</h4>
            </div>
            <div id="login-alert" class="alert alert-danger d-none" role="alert">
                <i class="fas fa-exclamation-circle me-2"></i><span data-i18n="loginError">ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼</span>
            </div>
            <form id="login-form">
                <div class="mb-3">
                    <label for="username" class="form-label" data-i18n="usernameLabel">ç”¨æˆ·å</label>
                    <input type="text" class="form-control" id="username" value="admin" required>
                </div>
                <div class="mb-4">
                    <label for="password" class="form-label" data-i18n="passwordLabel">å¯†ç </label>
                    <input type="password" class="form-control" id="password" required>
                </div>
                <button type="submit" class="btn btn-primary w-100" data-i18n="loginButton">ç™»å½•</button>
            </form>
        </div>
    </div>
    
    <div id="dashboard-container" class="container-fluid d-none" style="padding-top: 20px;">
        <div class="row">
            
            <div class="col-lg-2 col-md-3 sidebar-nav">
                <div class="d-flex flex-column align-items-center mb-4 pt-3">
                    <img src="logokeyhome.jpeg" alt="KeyHome Logo" style="height: 60px; width: auto; object-fit: contain; margin-bottom: 8px;">
                    <h5 class="m-0 text-primary fw-bold">KeyHome PM System</h5>
                </div>
                <ul class="nav nav-pills flex-column mb-auto" id="main-tabs" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="sales-summary-tab" data-bs-toggle="tab" href="#sales-summary-content" role="tab" aria-controls="sales-summary-content" aria-selected="true">
                            <i class="fas fa-chart-line me-2"></i><span data-i18n="salesSummaryTitle">é”€å”®æ¦‚è§ˆ</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="tenants-tab" data-bs-toggle="tab" href="#tenants-content" role="tab" aria-controls="tenants-content" aria-selected="false">
                            <i class="fas fa-user-friends me-2"></i><span data-i18n="tenantsTitle">ç§Ÿæˆ·ç®¡ç†</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="properties-tab" data-bs-toggle="tab" href="#properties-content" role="tab" aria-controls="properties-content" aria-selected="false">
                            <i class="fas fa-building me-2"></i><span data-i18n="propertyListTitle">ç‰©ä¸šæ¸…å•</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="landlords-tab" data-bs-toggle="tab" href="#landlords-content" role="tab" aria-controls="landlords-content" aria-selected="false">
                            <i class="fas fa-handshake me-2"></i><span data-i18n="landlordsTitle">ä¸šä¸»ç®¡ç†</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="finance-status-tab" data-bs-toggle="tab" href="#finance-status-content" role="tab" aria-controls="finance-status-content" aria-selected="false">
                            <i class="fas fa-funnel-dollar me-2"></i><span data-i18n="financeStatusTitle">è´¢åŠ¡çŠ¶æ€</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="maintenance-tab" data-bs-toggle="tab" href="#maintenance-content" role="tab" aria-controls="maintenance-content" aria-selected="false">
                            <i class="fas fa-tools me-2"></i><span data-i18n="maintenanceTitle">ç»´æŠ¤ä¸æŠ•è¯‰</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="user-management-tab" data-bs-toggle="tab" href="#user-management-content" role="tab" aria-controls="user-management-content" aria-selected="false">
                            <i class="fas fa-users-cog me-2"></i><span data-i18n="userManagementTitle">ç”¨æˆ·ç®¡ç†</span>
                        </a>
                    </li>
                </ul>
                
                <hr>
                
                <div class="d-flex flex-column gap-2">
                    <div class="dropdown">
                        <button class="btn btn-secondary dropdown-toggle w-100" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-globe me-2"></i> <span id="current-lang-text">ä¸­æ–‡</span>
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#" onclick="setLanguage('zh')">ä¸­æ–‡</a></li>
                            <li><a class="dropdown-item" href="#" onclick="setLanguage('en')">English</a></li>
                        </ul>
                    </div>
                    <button class="btn btn-outline-danger w-100" onclick="logout()">
                        <i class="fas fa-sign-out-alt me-2"></i> <span data-i18n="logoutButton">ç™»å‡º</span>
                    </button>
                </div>
            </div>

            <div class="col-lg-10 col-md-9">
                <div class="tab-content" id="main-tab-content">

                    <div class="tab-pane fade show active" id="sales-summary-content" role="tabpanel" aria-labelledby="sales-summary-tab">
                        <h1 class="mb-4 text-primary" data-i18n="salesSummaryTitle"><i class="fas fa-chart-bar me-2"></i>é”€å”®æ¦‚è§ˆ</h1>
                        <div class="row g-4 mb-5">
                            <div class="col-xl-3 col-md-6">
                                <div class="card bg-subtle-primary h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <div>
                                                <div class="card-title text-muted mb-1 small" data-i18n="summaryTotalProperties">æ€»ç‰©ä¸šæ•°é‡</div>
                                                <div class="summary-card-value text-primary" id="total-properties-value">50</div>
                                                <div class="trend-indicator text-up"><i class="fas fa-arrow-up me-1"></i>+2.0% <span data-i18n="YoY">YoY</span></div>
                                            </div>
                                            <i class="fas fa-city summary-card-icon text-primary"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6">
                                <div class="card bg-subtle-accent h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <div>
                                                <div class="card-title text-muted mb-1 small" data-i18n="summaryRentCollected">æœ¬æœˆå·²æ”¶ç§Ÿé‡‘</div>
                                                <div class="summary-card-value text-accent" id="rent-collected-value">RM 48,000</div>
                                                <div class="trend-indicator text-down"><i class="fas fa-arrow-down me-1"></i>-1.5% <span data-i18n="MoM">MoM</span></div>
                                            </div>
                                            <i class="fas fa-dollar-sign summary-card-icon text-accent"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6">
                                <div class="card bg-subtle-danger h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <div>
                                                <div class="card-title text-muted mb-1 small" data-i18n="summaryVacancyRate">å½“å‰ç©ºç½®ç‡</div>
                                                <div class="summary-card-value text-danger" id="vacancy-rate-value">4.0%</div>
                                                <div class="trend-indicator text-up"><i class="fas fa-arrow-up me-1"></i>+0.5pp <span data-i18n="MoM">MoM</span></div>
                                            </div>
                                            <i class="fas fa-door-open summary-card-icon text-danger"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-md-6">
                                <div class="card bg-subtle-warning h-100">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <div>
                                                <div class="card-title text-muted mb-1 small" data-i18n="summaryExpiringLeases">ç§Ÿçº¦å³å°†åˆ°æœŸ (30å¤©å†…)</div>
                                                <div class="summary-card-value text-warning" id="expiring-leases-value">5</div>
                                                <div class="trend-indicator text-down"><i class="fas fa-arrow-down me-1"></i>-2 <span data-i18n="YoY">YoY</span></div>
                                            </div>
                                            <i class="fas fa-calendar-times summary-card-icon text-warning"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row g-4">
                            <div class="col-lg-8">
                                <div class="card mb-4 chart-card">
                                    <div class="card-header d-flex justify-content-between align-items-center">
                                        <span data-i18n="annualIncomeTrendTitle"><i class="fas fa-chart-line me-2"></i>æ”¶å…¥ä¸æ”¯å‡ºè¶‹åŠ¿ (RM)</span>
                                        <div class="btn-group btn-group-sm">
                                            <button type="button" class="btn btn-outline-primary active" data-chart-period="M" data-i18n="chartPeriodM">æœˆ</button>
                                            <button type="button" class="btn btn-outline-primary" data-chart-period="Q" data-i18n="chartPeriodQ">å­£</button>
                                            <button type="button" class="btn btn-outline-primary" data-chart-period="Y" data-i18n="chartPeriodY">å¹´</button>
                                        </div>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="chartAnnualIncome" style="height: 350px;"></canvas>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-4">
                                <div class="card mb-4">
                                    <div class="card-header" data-i18n="financeDistributionTitle">ç§Ÿé‡‘æ”¶æ”¯åˆ†å¸ƒ</div> 
                                    <div class="card-body d-flex justify-content-center align-items-center" style="height: 350px;">
                                        <canvas id="chartPropertyStatus"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card mt-4">
                            <div class="card-header bg-danger text-white" data-i18n="urgentActionTitle"><i class="fas fa-exclamation-triangle me-2"></i>ç´§æ€¥è¡ŒåŠ¨ä¸æé†’</div>
                            <div class="card-body p-0">
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <div data-i18n="action1">ğŸ› ï¸ P003 (KLCC) æµ´å®¤æ¼æ°´ - **é«˜ä¼˜å…ˆçº§**å·¥å• M011 å¾…ä¾›åº”å•†ç¡®è®¤ã€‚</div>
                                        <button class="btn btn-sm btn-outline-danger">æŸ¥çœ‹å·¥å•</button>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <div data-i18n="action2">âš ï¸ ç§Ÿæˆ· John Smith (P003) ç§Ÿé‡‘é€¾æœŸ **5 å¤©** (RM 2,550.00)ã€‚</div>
                                        <button class="btn btn-sm btn-outline-warning">å‘é€æé†’</button>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        <div data-i18n="action3">ğŸ”‘ P002 (PJ Sentral) å¾…å‡†å¤‡ç‰©ä¸šï¼Œä¸‹å‘¨éœ€å®‰æ’çœ‹æˆ¿ã€‚</div>
                                        <button class="btn btn-sm btn-outline-primary">å®‰æ’æ—¥ç¨‹</button>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="tenants-content" role="tabpanel" aria-labelledby="tenants-tab">
                        <h1 class="mb-4 text-accent" data-i18n="tenantsTitle"><i class="fas fa-user-friends me-2"></i>ç§Ÿæˆ·ç®¡ç†</h1>
                        <p class="text-muted" data-i18n="tenantsSubtitle">ç®¡ç†æ‰€æœ‰ç§Ÿæˆ·ä¿¡æ¯ã€ç§Ÿçº¦çŠ¶æ€å’Œè”ç³»æ–¹å¼ã€‚ç§Ÿçº¦æ•°é‡ï¼š48ã€‚</p>

                        <div class="card mb-4">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <span data-i18n="activeTenantsList">å½“å‰æ´»è·ƒç§Ÿæˆ·åˆ—è¡¨</span>
                                <button class="btn btn-sm btn-primary" data-i18n="exportDataButton"><i class="fas fa-download me-1"></i>å¯¼å‡ºæ•°æ®</button>
                            </div>
                            <div class="card-body p-3">
                                <div class="input-group mb-3">
                                    <input type="text" class="form-control" data-i18n="[placeholder]searchTenantPlaceholder" placeholder="æŒ‰å§“åã€ç‰©ä¸š ID æˆ–ç§Ÿçº¦çŠ¶æ€ç­›é€‰...">
                                    <select class="form-select w-auto" id="tenant-status-filter">
                                        <option value="" data-i18n="filterAll">æ‰€æœ‰çŠ¶æ€</option>
                                        <option value="active" data-i18n="filterActive">æ´»è·ƒ</option>
                                        <option value="expiring" data-i18n="filterExpiring">å³å°†åˆ°æœŸ</option>
                                        <option value="overdue" data-i18n="filterOverdue">ç§Ÿé‡‘é€¾æœŸ</option>
                                    </select>
                                </div>
                                
                                <div class="table-responsive">
                                    <table class="table table-hover align-middle" id="tenant-table">
                                        <thead class="table-light">
                                            <tr>
                                                <th class="sortable-th" data-sort-key="tenant" onclick="sortTable('tenant-table', 0)">
                                                    <span data-i18n="tableHeaderTenant">ç§Ÿæˆ·</span> <i class="fas fa-sort sort-icon"></i>
                                                </th>
                                                <th class="sortable-th" data-sort-key="property_id" onclick="sortTable('tenant-table', 1)">
                                                    <span data-i18n="tableHeaderProperty">ç‰©ä¸š ID / åœ°å€</span> <i class="fas fa-sort sort-icon"></i>
                                                </th>
                                                <th class="sortable-th" data-sort-key="rent" data-sort-type="number" onclick="sortTable('tenant-table', 2)">
                                                    <span data-i18n="tableHeaderRent">æœˆç§Ÿ (RM)</span> <i class="fas fa-sort sort-icon"></i>
                                                </th>
                                                <th data-i18n="tableHeaderPIC">Appointed PIC</th>
                                                <th data-i18n="tableHeaderTenantRemark">å¤‡æ³¨</th>
                                                <th data-i18n="tableHeaderReferAgent">ä»‹ç»ä»£ç†</th>
                                                <th data-i18n="tableHeaderAgentContact">ä»£ç†è”ç³»</th>
                                                <th data-i18n="tableHeaderAgentCompany">ä»£ç†å…¬å¸</th>
                                                <th class="sortable-th" data-sort-key="lease_end" data-sort-type="date" onclick="sortTable('tenant-table', 8)">
                                                    <span data-i18n="tableHeaderLeaseEnd">ç§Ÿçº¦åˆ°æœŸæ—¥</span> <i class="fas fa-sort sort-icon"></i>
                                                </th>
                                                <th class="sortable-th" data-sort-key="status" onclick="sortTable('tenant-table', 9)">
                                                    <span data-i18n="tableHeaderStatus">çŠ¶æ€</span> <i class="fas fa-sort sort-icon"></i>
                                                </th>
                                                <th data-i18n="tableHeaderActions">æ“ä½œ</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr data-status="active">
                                                <td>Jane Doe</td>
                                                <td>P001 / Laman Cengal</td>
                                                <td data-sort-value="3000">3,000.00</td>
                                                <td>Alice (A01)</td> <td>æŒ‰æ—¶ç¼´ç§Ÿ</td> <td>Agent A</td> <td>012-1111222</td> <td>Company X</td> <td data-sort-value="2026-03-31">2026-03-31</td>
                                                <td><span class="badge bg-success" data-i18n="statusActive">æ´»è·ƒ</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-info me-1" data-i18n="actionEdit">ç¼–è¾‘</button>
                                                    <button class="btn btn-sm btn-outline-primary" data-i18n="actionContact">è”ç³»</button>
                                                </td>
                                            </tr>
                                            <tr data-status="overdue">
                                                <td>John Smith</td>
                                                <td>P003 / Taman Impian</td>
                                                <td data-sort-value="2550">2,550.00</td>
                                                <td>Bob (B02)</td> <td class="text-danger">ç»å¸¸è¿Ÿäº¤</td> <td>N/A</td> <td>N/A</td> <td>N/A</td> <td data-sort-value="2026-01-31">2026-01-31</td>
                                                <td><span class="badge bg-danger" data-i18n="statusOverdue">é€¾æœŸ (5å¤©)</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-info me-1" data-i18n="actionEdit">ç¼–è¾‘</button>
                                                    <button class="btn btn-sm btn-danger" data-i18n="actionCollect">æ”¶ç§Ÿ</button>
                                                </td>
                                            </tr>
                                            <tr data-status="expiring">
                                                <td>Ahmad Bin Kassim</td>
                                                <td>P015 / Sentral Tower</td>
                                                <td data-sort-value="4500">4,500.00</td>
                                                <td>Alice (A01)</td> <td>æœ‰ç»­çº¦æ„å‘</td> <td>Agent C</td> <td>017-3334444</td> <td>Company Z</td> <td data-sort-value="2026-02-28">2026-02-28</td>
                                                <td><span class="badge bg-warning text-dark" data-i18n="statusExpiring">å³å°†åˆ°æœŸ</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-info me-1" data-i18n="actionEdit">ç¼–è¾‘</button>
                                                    <button class="btn btn-sm btn-outline-warning" data-i18n="actionRenew">ç»­çº¦</button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <p class="text-end text-muted small mt-2" data-i18n="tableFooterHint">ç‚¹å‡»è¡¨å¤´å¯è¿›è¡Œæ’åºï¼Œä½¿ç”¨æœç´¢æ¡†è¿›è¡Œå³æ—¶ç­›é€‰ã€‚</p>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="properties-content" role="tabpanel" aria-labelledby="properties-tab">
                        <h1 class="mb-4 text-primary" data-i18n="propertyListTitle"><i class="fas fa-building me-2"></i>ç‰©ä¸šæ¸…å•</h1>
                        <p class="text-muted" data-i18n="propertyListSubtitle">ç®¡ç†æ‰€æœ‰å—æ‰˜ç‰©ä¸šçš„è¯¦ç»†ä¿¡æ¯ã€çŠ¶æ€å’Œç›¸å…³ä¸šä¸»ã€‚</p>

                        <div class="d-flex justify-content-between mb-3">
                            <button class="btn btn-primary" data-i18n="addNewPropertyButton"><i class="fas fa-plus me-1"></i>æ–°å¢ç‰©ä¸š</button>
                            <div class="input-group w-75">
                                <input type="text" class="form-control" data-i18n="[placeholder]searchPropertyPlaceholder" placeholder="æŒ‰ç‰©ä¸šåœ°å€æˆ–IDæœç´¢...">
                                <select class="form-select w-auto" id="property-status-filter" onchange="filterPropertyCards()">
                                    <option value="" data-i18n="filterAll">æ‰€æœ‰çŠ¶æ€</option>
                                    <option value="rented" data-i18n="statusRented">å·²ç§Ÿ</option>
                                    <option value="renovation" data-i18n="statusRenovation">è£…ä¿®ä¸­</option>
                                    <option value="preparing" data-i18n="statusPreparing">å¾…å‡†å¤‡</option>
                                </select>
                                <select class="form-select w-auto" id="property-location-filter" onchange="filterPropertyCards()">
                                    <option value="" data-i18n="filterAllLocations">æ‰€æœ‰åœ°ç‚¹ (åˆ†ç»„ç­›é€‰)</option>
                                    <option value="KL">KL Sentral</option>
                                    <option value="PJ">PJ Area</option>
                                    <option value="Puchong">Puchong</option>
                                </select>
                            </div>
                        </div>

                        <div class="row g-4" id="property-cards-container">
                            <div class="col-md-6 col-lg-4 property-card" data-status="rented" data-location="KL">
                                <div class="card property-list-card rented shadow-sm">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <h5 class="card-title-status text-success"><i class="fas fa-check-circle me-2"></i><span data-i18n="statusRented">å·²ç§Ÿ</span></h5>
                                            <span class="badge bg-success">P001</span>
                                        </div>
                                        <h6 class="card-subtitle mb-2 text-dark" data-i18n="propAddress1">201 Laman Cengal, KL</h6>
                                        <ul class="list-unstyled small mt-3">
                                            <li><i class="fas fa-user-tie me-2 text-muted"></i><strong data-i18n="ownerLabel">ä¸šä¸»:</strong> Tan Chee Ming (O001)</li>
                                            <li><i class="fas fa-user-friends me-2 text-muted"></i><strong data-i18n="tenantLabel">ç§Ÿæˆ·:</strong> Jane Doe</li>
                                            <li><i class="fas fa-ring me-2 text-muted"></i><strong data-i18n="rentDueLabel">ä¸‹æ¬¡æ”¶ç§Ÿ:</strong> 2026-01-01</li>
                                            <li><i class="fas fa-calendar-times me-2 text-muted"></i><strong data-i18n="leaseExpLabel">ç§Ÿçº¦åˆ°æœŸ:</strong> 2026-03-31</li>
                                            <li><i class="fas fa-user me-2 text-muted"></i><strong data-i18n="picLabel">PIC:</strong> Alice (A01)</li>
                                        </ul>
                                        <a href="#" class="btn btn-sm btn-outline-info mt-2" data-i18n="actionViewDetails">æŸ¥çœ‹è¯¦æƒ…</a>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6 col-lg-4 property-card" data-status="preparing" data-location="PJ">
                                <div class="card property-list-card preparing shadow-sm">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <h5 class="card-title-status text-primary"><i class="fas fa-bed me-2"></i><span data-i18n="statusPreparing">å¾…å‡†å¤‡</span></h5>
                                            <span class="badge bg-primary">P002</span>
                                        </div>
                                        <h6 class="card-subtitle mb-2 text-dark" data-i18n="propAddress2">A-12-05 Sentral Tower, PJ</h6>
                                        <ul class="list-unstyled small mt-3">
                                            <li><i class="fas fa-user-tie me-2 text-muted"></i><strong data-i18n="ownerLabel">ä¸šä¸»:</strong> Lim Wei Han (O002)</li>
                                            <li><i class="fas fa-user-friends me-2 text-danger"></i><strong data-i18n="tenantLabel">ç§Ÿæˆ·:</strong> <span data-i18n="noTenant">æ— ç§Ÿæˆ·</span></li>
                                            <li><i class="fas fa-ring me-2 text-muted"></i><strong data-i18n="rentDueLabel">ä¸‹æ¬¡æ”¶ç§Ÿ:</strong> N/A</li>
                                            <li><i class="fas fa-calendar-times me-2 text-muted"></i><strong data-i18n="vacantSinceLabel">ç©ºç½®èµ·å§‹:</strong> 2025-11-01</li>
                                            <li><i class="fas fa-user me-2 text-muted"></i><strong data-i18n="picLabel">PIC:</strong> Bob (B02)</li>
                                        </ul>
                                        <a href="#" class="btn btn-sm btn-outline-warning mt-2" data-i18n="actionScheduleViewing">å®‰æ’çœ‹æˆ¿</a>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6 col-lg-4 property-card" data-status="renovation" data-location="Puchong">
                                <div class="card property-list-card renovation shadow-sm">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between">
                                            <h5 class="card-title-status text-warning"><i class="fas fa-hammer me-2"></i><span data-i18n="statusRenovation">è£…ä¿®ä¸­</span></h5>
                                            <span class="badge bg-warning text-dark">P003</span>
                                        </div>
                                        <h6 class="card-subtitle mb-2 text-dark" data-i18n="propAddress3">15 Taman Impian, Puchong</h6>
                                        <ul class="list-unstyled small mt-3">
                                            <li><i class="fas fa-user-tie me-2 text-muted"></i><strong data-i18n="ownerLabel">ä¸šä¸»:</strong> Puan Siti (O003)</li>
                                            <li><i class="fas fa-user-friends me-2 text-muted"></i><strong data-i18n="tenantLabel">ç§Ÿæˆ·:</strong> John Smith</li>
                                            <li><i class="fas fa-ring me-2 text-danger"></i><strong data-i18n="rentDueLabel">ä¸‹æ¬¡æ”¶ç§Ÿ:</strong> **é€¾æœŸ 5 å¤©**</li>
                                            <li><i class="fas fa-calendar-times me-2 text-danger"></i><strong data-i18n="leaseExpLabel">ç§Ÿçº¦åˆ°æœŸ:</strong> **2026-01-31**</li>
                                            <li><i class="fas fa-user me-2 text-muted"></i><strong data-i18n="picLabel">PIC:</strong> Alice (A01)</li>
                                        </ul>
                                        <a href="#" class="btn btn-sm btn-outline-danger mt-2" data-i18n="actionUrgentCall">ç´§æ€¥è”ç³»</a>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="property-sort-trigger" class="d-none"></div>

                        </div>
                    </div>
                    
                    <div class="tab-pane fade" id="landlords-content" role="tabpanel" aria-labelledby="landlords-tab">
                        <h1 class="mb-4 text-info"><i class="fas fa-handshake me-2"></i><span data-i18n="landlordsTitle">ä¸šä¸»ç®¡ç†</span></h1>
                        <p class="text-muted" data-i18n="landlordsSubtitle">ç®¡ç†æ‰€æœ‰ä¸šä¸»åŠåˆä½œä»£ç†çš„è¯¦ç»†ä¿¡æ¯ã€‚</p>
                        
                        <div class="card mb-4">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <span data-i18n="landlordsList">ä¸šä¸»ä¿¡æ¯åˆ—è¡¨</span>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-sm btn-info text-white" data-i18n="addNewLandlordButton"><i class="fas fa-plus me-1"></i>æ–°å¢ä¸šä¸»</button>
                                    <select class="form-select w-auto" id="landlord-location-filter" onchange="filterLandlordTable()">
                                        <option value="" data-i18n="filterAllLocations">æ‰€æœ‰åœ°ç‚¹ (åˆ†ç»„ç­›é€‰)</option>
                                        <option value="KL">KL Sentral</option>
                                        <option value="PJ">PJ Area</option>
                                        <option value="Puchong">Puchong</option>
                                    </select>
                                </div>
                            </div>
                            <div class="card-body p-3">
                                <div class="table-responsive">
                                    <table class="table table-hover align-middle" id="landlord-table">
                                        <thead class="table-light">
                                            <tr>
                                                <th class="sortable-th" data-sort-key="owner" onclick="sortTable('landlord-table', 0)"><span data-i18n="tableHeaderOwner">ä¸šä¸»å§“å</span> <i class="fas fa-sort sort-icon"></i></th>
                                                <th class="sortable-th" data-sort-key="contact" onclick="sortTable('landlord-table', 1)"><span data-i18n="tableHeaderContact">è”ç³»æ–¹å¼</span> <i class="fas fa-sort sort-icon"></i></th>
                                                <th class="sortable-th" data-sort-key="property_location" onclick="sortTable('landlord-table', 2)"><span data-i18n="tableHeaderLocation">ä¸»è¦ç‰©ä¸šåœ°ç‚¹</span> <i class="fas fa-sort sort-icon"></i></th>
                                                <th data-i18n="tableHeaderPIC">Appointed PIC</th>
                                                <th data-i18n="tableHeaderLandlordRemark">ä¸šä¸»å¤‡æ³¨</th>
                                                <th class="sortable-th" data-sort-key="agent" onclick="sortTable('landlord-table', 5)"><span data-i18n="tableHeaderReferAgent">ä»‹ç»ä»£ç†</span> <i class="fas fa-sort sort-icon"></i></th>
                                                <th data-i18n="tableHeaderAgentContact">ä»£ç†è”ç³»</th>
                                                <th data-i18n="tableHeaderAgentCompany">ä»£ç†å…¬å¸</th>
                                                <th class="sortable-th" data-sort-key="agreement_end" data-sort-type="date" onclick="sortTable('landlord-table', 8)"><span data-i18n="tableHeaderAgreementEnd">åè®®åˆ°æœŸæ—¥</span> <i class="fas fa-sort sort-icon"></i></th>
                                                <th data-i18n="tableHeaderDeposit">æŠ¼é‡‘è¯¦æƒ…</th>
                                                <th data-i18n="tableHeaderActions">æ“ä½œ</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr data-location="KL">
                                                <td>Tan Chee Ming (O001)</td>
                                                <td>012-3456789</td>
                                                <td data-sort-value="KL">KL Sentral</td>
                                                <td>Alice (A01)</td> <td>é«˜è¦æ±‚ä¸šä¸»</td> <td>Agent A</td>
                                                <td>012-1111222</td> <td>Company X</td> <td data-sort-value="2027-12-31">2027-12-31</td>
                                                <td>3 Months</td>
                                                <td><button class="btn btn-sm btn-outline-info">è¯¦æƒ…</button></td>
                                            </tr>
                                            <tr data-location="PJ">
                                                <td>Lim Wei Han (O002)</td>
                                                <td>016-9876543</td>
                                                <td data-sort-value="PJ">PJ Area</td>
                                                <td>Bob (B02)</td> <td>åªéœ€å­£æŠ¥</td> <td>N/A</td>
                                                <td>N/A</td> <td>N/A</td> <td data-sort-value="2026-06-30">2026-06-30</td>
                                                <td>2 Months</td>
                                                <td><button class="btn btn-sm btn-outline-info">è¯¦æƒ…</button></td>
                                            </tr>
                                            <tr data-location="Puchong">
                                                <td>Puan Siti (O003)</td>
                                                <td>019-1122334</td>
                                                <td data-sort-value="Puchong">Puchong</td>
                                                <td>Alice (A01)</td> <td>æ–°å®¢æˆ·</td> <td>Agent C</td>
                                                <td>017-3334444</td> <td>Company Z</td> <td data-sort-value="2028-01-15">2028-01-15</td>
                                                <td>1 Month</td>
                                                <td><button class="btn btn-sm btn-outline-info">è¯¦æƒ…</button></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="finance-status-content" role="tabpanel" aria-labelledby="finance-status-tab">
                        <h1 class="mb-4 text-success" data-i18n="financeStatusTitle"><i class="fas fa-funnel-dollar me-2"></i>è´¢åŠ¡çŠ¶æ€</h1>
                        <p class="text-muted" data-i18n="financeStatusSubtitle">è¯¦ç»†æŸ¥çœ‹æ”¶å…¥ã€æ”¯å‡ºã€å‡€ç°é‡‘æµå’Œå¹´åº¦é¢„ç®—æ‰§è¡Œæƒ…å†µã€‚</p>
                                    
                        <div class="row g-4 mb-4">
                            <div class="col-md-4">
                                <div class="card finance-kpi-card-income"><div class="card-body"><h5 class="card-title" data-i18n="monthlyIncomeTitle">æœ¬æœˆæ”¶å…¥</h5><p class="card-text summary-card-value">RM 55,000</p></div></div>
                            </div>
                            <div class="col-md-4">
                                <div class="card finance-kpi-card-expense"><div class="card-body"><h5 class="card-title" data-i18n="monthlyExpenseTitle">æœ¬æœˆæ”¯å‡º</h5><p class="card-text summary-card-value">RM 18,500</p></div></div>
                            </div>
                            <div class="col-md-4">
                                <div class="card finance-kpi-card-netflow"><div class="card-body"><h5 class="card-title" data-i18n="netCashFlowTitle">æœ¬æœˆå‡€ç°é‡‘æµ</h5><p class="card-text summary-card-value">RM 36,500</p></div></div>
                            </div>
                        </div>
                                    
                        <div class="card mt-4">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <span data-i18n="incomeExpenseTrendTitle"><i class="fas fa-chart-area me-2"></i>æ”¶å…¥ä¸æ”¯å‡ºè¶‹åŠ¿ (è¿‡å» 12 ä¸ªæœˆ)</span>
                                <button class="btn btn-sm btn-outline-success" data-i18n="exportFinancialButton"><i class="fas fa-download me-1"></i>å¯¼å‡ºè´¢åŠ¡æŠ¥è¡¨</button>
                            </div>
                            <div class="card-body">
                                <canvas id="chartIncomeExpenseTrend" style="height: 400px;"></canvas>
                                
                                <h5 class="mt-4" data-i18n="detailedStatementTitle">è¯¦ç»†è´¢åŠ¡åˆ—è¡¨</h5>
                                <p class="text-muted small" data-i18n="statementHint">ä¸‹æ–¹è¡¨æ ¼åŒ…å«æ”¶å…¥ã€æ”¯å‡ºå’Œåº”æ”¶è´¦æ¬¾ï¼ˆReceivableï¼‰çš„è¯¦ç»†äº¤æ˜“è®°å½•ã€‚</p>
                                <div class="table-responsive">
                                    <table class="table table-striped table-sm">
                                        <thead class="table-dark">
                                            <tr>
                                                <th data-i18n="tableHeaderDate">æ—¥æœŸ</th>
                                                <th data-i18n="tableHeaderDescription">æè¿°</th>
                                                <th data-i18n="tableHeaderType">ç±»å‹</th>
                                                <th data-i18n="tableHeaderAmount">é‡‘é¢ (RM)</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr><td>2025-12-01</td><td>P001 ç§Ÿé‡‘</td><td><span class="badge bg-accent">æ”¶å…¥</span></td><td>3,000.00</td></tr>
                                            <tr><td>2025-12-05</td><td>ç”µè´¹ P005</td><td><span class="badge bg-danger">æ”¯å‡º</span></td><td>-450.00</td></tr>
                                            <tr><td>2025-12-10</td><td>P003 ç§Ÿé‡‘ (é€¾æœŸ)</td><td><span class="badge bg-warning text-dark">åº”æ”¶</span></td><td>2,550.00</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="maintenance-content" role="tabpanel" aria-labelledby="maintenance-tab">
                        <h1 class="mb-4 text-warning" data-i18n="maintenanceTitle"><i class="fas fa-tools me-2"></i>ç»´æŠ¤ä¸æŠ•è¯‰</h1>
                        <p class="text-muted" data-i18n="maintenanceSubtitle">è·Ÿè¸ªæ‰€æœ‰ç»´æŠ¤å’Œä¿®ç†è¯·æ±‚çš„çŠ¶æ€å’Œè¿›åº¦ã€‚</p>
                        
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <span data-i18n="openTicketsList">å¼€æ”¾å·¥å•åˆ—è¡¨ (å…± 7 ä¸ª)</span>
                                <button class="btn btn-sm btn-warning text-dark" data-i18n="newTicketButton"><i class="fas fa-plus me-1"></i>åˆ›å»ºæ–°å·¥å•</button>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead class="table-light">
                                            <tr>
                                                <th data-i18n="ticketID">ID</th>
                                                <th data-i18n="ticketProperty">ç‰©ä¸š</th>
                                                <th data-i18n="ticketIssue">é—®é¢˜</th>
                                                <th data-i18n="ticketPriority">ä¼˜å…ˆçº§</th>
                                                <th data-i18n="ticketStatus">çŠ¶æ€</th>
                                                <th data-i18n="ticketCreated">åˆ›å»ºæ—¶é—´</th>
                                                <th data-i18n="ticketActions">æ“ä½œ</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr class="table-danger">
                                                <td>M011</td>
                                                <td>P003</td>
                                                <td data-i18n="issueLeak">æµ´å®¤æ¼æ°´</td>
                                                <td><span class="badge bg-danger" data-i18n="priorityHigh">é«˜</span></td>
                                                <td><span class="badge bg-warning text-dark" data-i18n="statusPending">å¾…ç¡®è®¤</span></td>
                                                <td>2025-12-10</td>
                                                <td><button class="btn btn-sm btn-outline-danger">è¯¦æƒ…</button></td>
                                            </tr>
                                            <tr class="table-warning">
                                                <td>M012</td>
                                                <td>P020</td>
                                                <td data-i18n="issueAC">ç©ºè°ƒä¸åˆ¶å†·</td>
                                                <td><span class="badge bg-warning text-dark" data-i18n="priorityMedium">ä¸­</span></td>
                                                <td><span class="badge bg-info" data-i18n="statusAssigned">å·²åˆ†é…</span></td>
                                                <td>2025-12-15</td>
                                                <td><button class="btn btn-sm btn-outline-info">è·Ÿè¸ª</button></td>
                                            </tr>
                                            <tr>
                                                <td>M013</td>
                                                <td>P001</td>
                                                <td data-i18n="issueDoor">å§å®¤é—¨é”æ¾åŠ¨</td>
                                                <td><span class="badge bg-success" data-i18n="priorityLow">ä½</span></td>
                                                <td><span class="badge bg-success" data-i18n="statusResolved">å·²è§£å†³</span></td>
                                                <td>2025-12-05</td>
                                                <td><button class="btn btn-sm btn-outline-secondary">å­˜æ¡£</button></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="user-management-content" role="tabpanel" aria-labelledby="user-management-tab">
                        <h1 class="mb-4 text-secondary"><i class="fas fa-users-cog me-2"></i><span data-i18n="userManagementTitle">ç”¨æˆ·ç®¡ç†</span></h1>
                        <p class="text-muted" data-i18n="userManagementSubtitle">ç®¡ç†ç³»ç»Ÿç”¨æˆ·åŠæˆæƒçº§åˆ«ã€‚ç®¡ç†å‘˜æ‹¥æœ‰æ·»åŠ ç”¨æˆ·æƒé™ã€‚</p>
                        
                        <div class="card mb-4">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <span data-i18n="userList">ç³»ç»Ÿç”¨æˆ·åˆ—è¡¨</span>
                                <button class="btn btn-sm btn-secondary" data-i18n="addNewUserButton" onclick="alert('æ–°å¢ç”¨æˆ·åŠŸèƒ½ (ä»…é™ç®¡ç†å‘˜)')"><i class="fas fa-user-plus me-1"></i>æ–°å¢ç”¨æˆ· (Admin)</button>
                            </div>
                            <div class="card-body p-3">
                                <div class="table-responsive">
                                    <table class="table table-hover align-middle">
                                        <thead class="table-light">
                                            <tr>
                                                <th data-i18n="tableHeaderUser">ç”¨æˆ·å</th>
                                                <th data-i18n="tableHeaderUserRole">è§’è‰²/æƒé™</th>
                                                <th data-i18n="tableHeaderUserEmail">é‚®ç®±</th>
                                                <th data-i18n="tableHeaderActions">æ“ä½œ</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>admin</td>
                                                <td><span class="badge bg-danger" data-i18n="roleAdmin">è¶…çº§ç®¡ç†å‘˜ (Admin)</span></td>
                                                <td>admin@keyhome.com</td>
                                                <td><button class="btn btn-sm btn-outline-danger" data-i18n="actionResetPW">é‡ç½®å¯†ç </button></td>
                                            </tr>
                                            <tr>
                                                <td>staff_a</td>
                                                <td><span class="badge bg-primary" data-i18n="roleStaff">å‘˜å·¥ (Staff)</span></td>
                                                <td>staff_a@keyhome.com</td>
                                                <td><button class="btn btn-sm btn-outline-secondary" data-i18n="actionEdit">ç¼–è¾‘</button></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        // --- æ¨¡æ‹Ÿæ•°æ®æº ---
        const salesData = {
            totalProperties: 50,
            occupied: 48,
            vacant: 2,
            rentCollected: 48000,
            totalMonthlyRentTarget: 50000, 
            rentOverdue: 2550, 
            expiringLeases: 5,
            
            // è¶‹åŠ¿æ•°æ® (æœˆåº¦/å­£åº¦/å¹´åº¦) - ä»¥åƒ RM è®¡
            trend: {
                M: {
                    labels: ['åæœˆ', 'åä¸€æœˆ', 'åäºŒæœˆ', 'ä¸€æœˆ', 'äºŒæœˆ', 'ä¸‰æœˆ'],
                    income: [53, 55, 54, 56, 58, 60], 
                    expense: [17, 18, 17, 19, 20, 21], 
                    MoM_Income: 3.45,
                    MoM_Vacancy: 0.5, 
                },
                Q: {
                    labels: ['Q1 2025', 'Q2 2025', 'Q3 2025', 'Q4 2025'],
                    income: [150, 160, 180, 175],
                    expense: [45, 48, 55, 52]
                },
                Y: {
                    labels: ['2023', '2024', '2025 (E)'],
                    income: [500, 620, 750],
                    expense: [150, 180, 220]
                }
            },
            
            financeMonths: ['ä¸€æœˆ', 'äºŒæœˆ', 'ä¸‰æœˆ', 'å››æœˆ', 'äº”æœˆ', 'å…­æœˆ', 'ä¸ƒæœˆ', 'å…«æœˆ', 'ä¹æœˆ', 'åæœˆ', 'åä¸€æœˆ', 'åäºŒæœˆ'],
            financeIncome: [55, 57, 60, 58, 62, 65, 68, 70, 72, 75, 78, 80], // in thousands RM
            financeExpense: [18, 19, 20, 19, 21, 22, 23, 24, 25, 26, 27, 28] // in thousands RM
        };

        // --- ç™»å½•/ç™»å‡ºé€»è¾‘ ---
        function checkLogin() {
            const loggedIn = localStorage.getItem('loggedIn');
            if (loggedIn === 'true') {
                showDashboard();
            } else {
                showLogin();
            }
        }

        function showLogin() {
            document.getElementById('login-container').classList.remove('d-none');
            document.getElementById('dashboard-container').classList.add('d-none');
            document.body.style.padding = '0';
        }

        function showDashboard() {
            document.getElementById('login-container').classList.add('d-none');
            document.getElementById('dashboard-container').classList.remove('d-none');
            // Ensure charts are drawn after showing the dashboard
            drawAllCharts(translations[currentLang]); 
        }

        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            const alertEl = document.getElementById('login-alert');

            // å®¢æˆ·ç«¯è®¤è¯ï¼šadmin / 123456
            if (username === 'admin' && password === '123456') {
                localStorage.setItem('loggedIn', 'true');
                alertEl.classList.add('d-none');
                showDashboard();
            } else {
                alertEl.classList.remove('d-none');
            }
        });

        function logout() {
            localStorage.removeItem('loggedIn');
            showLogin();
            // Optional: reset language on logout
            // setLanguage('zh'); 
        }

        // --- Chart.js åˆå§‹åŒ–å’Œæ§åˆ¶ (ä¿æŒä¸å˜) ---
        let charts = {};
        let currentChartPeriod = 'M'; 

        function createDoughnutChart(id, labels, data, colors) {
            const ctx = document.getElementById(id);
            if (!ctx) return;
            if (charts[id]) charts[id].destroy();
            
            charts[id] = new Chart(ctx.getContext('2d'), {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: colors,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom', labels: { boxWidth: 10 } },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const value = context.parsed;
                                    const percentage = ((value / total) * 100).toFixed(1) + '%';
                                    return `${context.label}: RM ${value.toLocaleString()} (${percentage})`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function createIncomeTrendChart(id, period, currentTranslation) {
            const ctx = document.getElementById(id);
            if (!ctx) return;
            if (charts[id]) charts[id].destroy();

            const dataSet = salesData.trend[period];
            
            charts[id] = new Chart(ctx.getContext('2d'), {
                type: 'bar', 
                data: {
                    labels: dataSet.labels,
                    datasets: [
                        {
                            label: currentTranslation['chartLabelIncome'],
                            data: dataSet.income,
                            backgroundColor: 'rgba(0, 86, 179, 0.7)',
                            yAxisID: 'y'
                        },
                        {
                            label: currentTranslation['chartLabelExpense'],
                            data: dataSet.expense,
                            backgroundColor: 'rgba(220, 53, 69, 0.7)',
                            yAxisID: 'y'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: currentTranslation['chartLabelAmountThousandsRM'] },
                            ticks: {
                                 callback: function(value) { return 'RM ' + value + 'k'; }
                            }
                        }
                    },
                    plugins: {
                        legend: { position: 'top' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: RM ${context.parsed.y.toLocaleString()}k`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function createFinanceLineChart(id, currentTranslation) {
            const ctx = document.getElementById(id);
            if (!ctx) return;
            if(charts[id]) charts[id].destroy();

            charts[id] = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: salesData.financeMonths,
                    datasets: [
                        {
                            label: currentTranslation['chartLabelTotalIncome'],
                            data: salesData.financeIncome,
                            borderColor: '#28a745',
                            backgroundColor: 'rgba(40, 167, 69, 0.1)',
                            fill: true,
                            tension: 0.3
                        },
                        {
                            label: currentTranslation['chartLabelTotalExpense'],
                            data: salesData.financeExpense,
                            borderColor: '#dc3545',
                            backgroundColor: 'rgba(220, 53, 69, 0.1)',
                            fill: false,
                            tension: 0.3
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            title: { display: true, text: currentTranslation['chartLabelAmountThousandsRM'] },
                            ticks: {
                                 callback: function(value) { return 'RM ' + value + 'k'; }
                            }
                        }
                    },
                    plugins: {
                        legend: { position: 'top' },
                        tooltip: {
                             callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: RM ${context.parsed.y}k`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function drawAllCharts(currentTranslation) {
            if (document.getElementById('dashboard-container').classList.contains('d-none')) return;

            // 1. æ›´æ–°ä»ªè¡¨æ¿æ‘˜è¦å¡ç‰‡ (KPI)
            const vacancyRate = (salesData.vacant / salesData.totalProperties) * 100;
            document.getElementById('total-properties-value').innerText = salesData.totalProperties;
            document.getElementById('rent-collected-value').innerText = `RM ${salesData.rentCollected.toLocaleString()}`;
            document.getElementById('vacancy-rate-value').innerText = `${vacancyRate.toFixed(1)}%`;
            document.getElementById('expiring-leases-value').innerText = salesData.expiringLeases;

            const incomeTrend = salesData.trend.M.MoM_Income;
            const vacancyTrend = salesData.trend.M.MoM_Vacancy;
            
            const rentTrendEl = document.querySelector('#rent-collected-value').nextElementSibling;
            rentTrendEl.innerText = `${incomeTrend.toFixed(2)}% ${currentTranslation['MoM']}`;
            rentTrendEl.className = `trend-indicator ${incomeTrend > 0 ? 'text-up' : 'text-down'}`;
            rentTrendEl.innerHTML = `<i class="fas fa-arrow-${incomeTrend > 0 ? 'up' : 'down'} me-1"></i>${incomeTrend.toFixed(2)}% <span data-i18n="MoM">${currentTranslation['MoM']}</span>`;
            
            const vacancyTrendEl = document.querySelector('#vacancy-rate-value').nextElementSibling;
            vacancyTrendEl.innerText = `${vacancyTrend}pp ${currentTranslation['MoM']}`;
            vacancyTrendEl.className = `trend-indicator ${vacancyTrend > 0 ? 'text-up text-danger' : 'text-down text-accent'}`;
            vacancyTrendEl.innerHTML = `<i class="fas fa-arrow-${vacancyTrend > 0 ? 'up' : 'down'} me-1"></i>${vacancyTrend}pp <span data-i18n="MoM">${currentTranslation['MoM']}</span>`;


            // 2. ç§Ÿé‡‘æ”¶æ”¯åˆ†å¸ƒå›¾ (Doughnut Chart)
            const rentReceived = salesData.rentCollected;
            const rentReceivable = salesData.totalMonthlyRentTarget - rentReceived;

            const rentLabels = [currentTranslation['chartLabelReceived'], currentTranslation['chartLabelReceivable']];
            const rentData = [rentReceived, rentReceivable];
            const rentColors = ['#28a745', '#ffc107']; 
            
            createDoughnutChart('chartPropertyStatus', rentLabels, rentData, rentColors);
            
            // 3. ä»ªè¡¨æ¿å¹´åº¦æ”¶å…¥è¶‹åŠ¿ (Bar Chart)
            createIncomeTrendChart(
                'chartAnnualIncome', 
                currentChartPeriod, 
                currentTranslation
            );

            // 4. è´¢åŠ¡çŠ¶æ€ - æ”¶å…¥ä¸æ”¯å‡ºè¶‹åŠ¿ (Line Chart)
            createFinanceLineChart('chartIncomeExpenseTrend', currentTranslation);
        }

        // --- æ’åºåŠŸèƒ½ (Sorting) ---
        // é€šç”¨è¡¨æ ¼æ’åºå‡½æ•°ï¼Œæ”¯æŒå­—ç¬¦ä¸²ã€æ•°å­—å’Œæ—¥æœŸ
        function sortTable(tableId, columnIndex) {
            const table = document.getElementById(tableId);
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));
            const header = table.querySelectorAll('th')[columnIndex];
            
            const sortType = header.getAttribute('data-sort-type') || 'string';
            let sortDirection = header.getAttribute('data-sort-direction') || 'asc';
            
            // æ¸…é™¤å…¶ä»–åˆ—çš„æ’åºçŠ¶æ€
            table.querySelectorAll('th').forEach(th => {
                th.classList.remove('sorted');
                const icon = th.querySelector('.sort-icon');
                if (icon) icon.className = 'fas fa-sort sort-icon';
            });
            
            // åˆ‡æ¢å½“å‰åˆ—çš„æ’åºæ–¹å‘
            sortDirection = (sortDirection === 'asc') ? 'desc' : 'asc';
            header.setAttribute('data-sort-direction', sortDirection);
            header.classList.add('sorted');
            
            // æ›´æ–°æ’åºå›¾æ ‡
            const icon = header.querySelector('.sort-icon');
            if (icon) icon.className = `fas fa-sort-${sortDirection} sort-icon`;

            rows.sort((rowA, rowB) => {
                const cellA = rowA.children[columnIndex];
                const cellB = rowB.children[columnIndex];

                // ä¼˜å…ˆä½¿ç”¨ data-sort-value
                const valA = cellA.getAttribute('data-sort-value') || cellA.innerText;
                const valB = cellB.getAttribute('data-sort-value') || cellB.innerText;

                let comparison = 0;

                if (sortType === 'number') {
                    comparison = parseFloat(valA.replace(/[^0-9.-]+/g, "")) - parseFloat(valB.replace(/[^0-9.-]+/g, ""));
                } else if (sortType === 'date') {
                    comparison = new Date(valA) - new Date(valB);
                } else { // 'string'
                    comparison = valA.localeCompare(valB, 'zh', { sensitivity: 'base' });
                }

                return sortDirection === 'asc' ? comparison : -comparison;
            });

            // é‡æ–°æ¸²æŸ“è¡¨æ ¼
            rows.forEach(row => tbody.appendChild(row));
        }

        // --- ç‰©ä¸šå¡ç‰‡æ’åº/åˆ†ç»„/ç­›é€‰ ---
        function filterPropertyCards() {
            const statusFilter = document.getElementById('property-status-filter').value;
            const locationFilter = document.getElementById('property-location-filter').value;
            const container = document.getElementById('property-cards-container');
            const cards = container.querySelectorAll('.property-card');
            
            // è¿‡æ»¤é€»è¾‘
            cards.forEach(card => {
                const status = card.getAttribute('data-status');
                const location = card.getAttribute('data-location');
                
                const statusMatch = !statusFilter || status === statusFilter;
                const locationMatch = !locationFilter || location === locationFilter;
                
                // Hide/show the parent column element
                card.parentNode.style.display = (statusMatch && locationMatch) ? 'block' : 'none';
            });
        }

        // --- ä¸šä¸»è¡¨æ ¼åˆ†ç»„/ç­›é€‰ ---
        function filterLandlordTable() {
            const locationFilter = document.getElementById('landlord-location-filter').value;
            const table = document.getElementById('landlord-table');
            const rows = table.querySelectorAll('tbody tr');

            rows.forEach(row => {
                const location = row.getAttribute('data-location');
                const locationMatch = !locationFilter || location === locationFilter;
                
                row.style.display = locationMatch ? '' : 'none';
            });
        }
        
        // --- å¤šè¯­è¨€åˆ‡æ¢æ•°æ® (Translations) ---
        const translations = {
            'zh': {
                'pageTitle': 'KeyHome æˆ¿äº§ç®¡ç†ç³»ç»Ÿ',
                'loginTitle': 'ç³»ç»Ÿç™»å½•',
                'usernameLabel': 'ç”¨æˆ·å',
                'passwordLabel': 'å¯†ç ',
                'loginButton': 'ç™»å½•',
                'loginError': 'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼',
                'logoutButton': 'ç™»å‡º',

                'salesSummaryTitle': 'é”€å”®æ¦‚è§ˆ',
                'tenantsTitle': 'ç§Ÿæˆ·ç®¡ç†',
                'propertyListTitle': 'ç‰©ä¸šæ¸…å•',
                'landlordsTitle': 'ä¸šä¸»ç®¡ç†',
                'financeStatusTitle': 'è´¢åŠ¡çŠ¶æ€',
                'maintenanceTitle': 'ç»´æŠ¤ä¸æŠ•è¯‰',
                'userManagementTitle': 'ç”¨æˆ·ç®¡ç†',
                
                // è§’è‰²
                'roleAdmin': 'è¶…çº§ç®¡ç†å‘˜ (Admin)',
                'roleStaff': 'å‘˜å·¥ (Staff)',
                
                // KPI
                'summaryTotalProperties': 'æ€»ç‰©ä¸šæ•°é‡',
                'summaryRentCollected': 'æœ¬æœˆå·²æ”¶ç§Ÿé‡‘',
                'summaryVacancyRate': 'å½“å‰ç©ºç½®ç‡',
                'summaryExpiringLeases': 'ç§Ÿçº¦å³å°†åˆ°æœŸ (30å¤©å†…)',
                'MoM': 'ç¯æ¯”', 'YoY': 'åŒæ¯”',
                
                // Charts Period (UPDATED)
                'chartPeriodM': 'æœˆ',
                'chartPeriodQ': 'å­£',
                'chartPeriodY': 'å¹´',

                // Charts
                'annualIncomeTrendTitle': 'æ”¶å…¥ä¸æ”¯å‡ºè¶‹åŠ¿ (RM)',
                'financeDistributionTitle': 'ç§Ÿé‡‘æ”¶æ”¯åˆ†å¸ƒ', 
                'chartLabelIncome': 'æ”¶å…¥',
                'chartLabelExpense': 'æ”¯å‡º',
                'chartLabelAmountThousandsRM': 'é‡‘é¢ (åƒ RM)',
                'chartLabelReceived': 'å·²æ”¶ç§Ÿé‡‘', 
                'chartLabelReceivable': 'å¾…æ”¶ç§Ÿé‡‘', 
                'urgentActionTitle': 'ç´§æ€¥è¡ŒåŠ¨ä¸æé†’',
                'action1': 'ğŸ› ï¸ P003 (KLCC) æµ´å®¤æ¼æ°´ - **é«˜ä¼˜å…ˆçº§**å·¥å• M011 å¾…ä¾›åº”å•†ç¡®è®¤ã€‚',
                'action2': 'âš ï¸ ç§Ÿæˆ· John Smith (P003) ç§Ÿé‡‘é€¾æœŸ **5 å¤©** (RM 2,550.00)ã€‚',
                'action3': 'ğŸ”‘ P002 (PJ Sentral) å¾…å‡†å¤‡ç‰©ä¸šï¼Œä¸‹å‘¨éœ€å®‰æ’çœ‹æˆ¿ã€‚',

                // ç§Ÿæˆ·ç®¡ç† (UPDATED)
                'tenantsSubtitle': 'ç®¡ç†æ‰€æœ‰ç§Ÿæˆ·ä¿¡æ¯ã€ç§Ÿçº¦çŠ¶æ€å’Œè”ç³»æ–¹å¼ã€‚ç§Ÿçº¦æ•°é‡ï¼š48ã€‚',
                'activeTenantsList': 'å½“å‰æ´»è·ƒç§Ÿæˆ·åˆ—è¡¨',
                'exportDataButton': 'å¯¼å‡ºæ•°æ®',
                '[placeholder]searchTenantPlaceholder': 'æŒ‰å§“åã€ç‰©ä¸š ID æˆ–ç§Ÿçº¦çŠ¶æ€ç­›é€‰...',
                'filterAll': 'æ‰€æœ‰çŠ¶æ€', 'filterActive': 'æ´»è·ƒ', 'filterExpiring': 'å³å°†åˆ°æœŸ', 'filterOverdue': 'ç§Ÿé‡‘é€¾æœŸ',
                'tableHeaderTenant': 'ç§Ÿæˆ·', 'tableHeaderProperty': 'ç‰©ä¸š ID / åœ°å€', 'tableHeaderRent': 'æœˆç§Ÿ (RM)', 
                'tableHeaderPIC': 'Appointed PIC', // NEW
                'tableHeaderTenantRemark': 'å¤‡æ³¨', // NEW
                'tableHeaderReferAgent': 'ä»‹ç»ä»£ç†', // NEW
                'tableHeaderAgentContact': 'ä»£ç†è”ç³»', // NEW
                'tableHeaderAgentCompany': 'ä»£ç†å…¬å¸', // NEW
                'tableHeaderLeaseEnd': 'ç§Ÿçº¦åˆ°æœŸæ—¥', 'tableHeaderStatus': 'çŠ¶æ€', 'tableHeaderActions': 'æ“ä½œ',
                'statusActive': 'æ´»è·ƒ', 'statusOverdue': 'é€¾æœŸ (5å¤©)', 'statusExpiring': 'å³å°†åˆ°æœŸ',
                'actionContact': 'è”ç³»', 'actionCollect': 'æ”¶ç§Ÿ', 'actionRenew': 'ç»­çº¦', 'actionEdit': 'ç¼–è¾‘', // NEW
                'tableFooterHint': 'ç‚¹å‡»è¡¨å¤´å¯è¿›è¡Œæ’åºï¼Œä½¿ç”¨æœç´¢æ¡†è¿›è¡Œå³æ—¶ç­›é€‰ã€‚',
                
                // ç‰©ä¸šæ¸…å•
                'propertyListSubtitle': 'ç®¡ç†æ‰€æœ‰å—æ‰˜ç‰©ä¸šçš„è¯¦ç»†ä¿¡æ¯ã€çŠ¶æ€å’Œç›¸å…³ä¸šä¸»ã€‚',
                'addNewPropertyButton': 'æ–°å¢ç‰©ä¸š',
                '[placeholder]searchPropertyPlaceholder': 'æŒ‰ç‰©ä¸šåœ°å€æˆ–IDæœç´¢...',
                'filterAllLocations': 'æ‰€æœ‰åœ°ç‚¹ (åˆ†ç»„ç­›é€‰)',
                'statusRented': 'å·²ç§Ÿ',
                'statusRenovation': 'è£…ä¿®ä¸­',
                'statusPreparing': 'å¾…å‡†å¤‡',
                'ownerLabel': 'ä¸šä¸»', 'tenantLabel': 'ç§Ÿæˆ·', 'rentDueLabel': 'ä¸‹æ¬¡æ”¶ç§Ÿ', 'leaseExpLabel': 'ç§Ÿçº¦åˆ°æœŸ', 'vacantSinceLabel': 'ç©ºç½®èµ·å§‹', 'noTenant': 'æ— ç§Ÿæˆ·',
                'picLabel': 'PIC', // NEW
                'actionViewDetails': 'æŸ¥çœ‹è¯¦æƒ…', 'actionScheduleViewing': 'å®‰æ’çœ‹æˆ¿', 'actionUrgentCall': 'ç´§æ€¥è”ç³»',
                'propAddress1': '201 Laman Cengal, KL', 'propAddress2': 'A-12-05 Sentral Tower, PJ', 'propAddress3': '15 Taman Impian, Puchong',

                // ä¸šä¸»ç®¡ç† (UPDATED)
                'landlordsSubtitle': 'ç®¡ç†æ‰€æœ‰ä¸šä¸»åŠåˆä½œä»£ç†çš„è¯¦ç»†ä¿¡æ¯ã€‚',
                'landlordsList': 'ä¸šä¸»ä¿¡æ¯åˆ—è¡¨',
                'addNewLandlordButton': 'æ–°å¢ä¸šä¸»',
                'tableHeaderOwner': 'ä¸šä¸»å§“å',
                'tableHeaderContact': 'è”ç³»æ–¹å¼',
                'tableHeaderLocation': 'ä¸»è¦ç‰©ä¸šåœ°ç‚¹',
                'tableHeaderLandlordRemark': 'ä¸šä¸»å¤‡æ³¨', // NEW
                'tableHeaderAgreementEnd': 'åè®®åˆ°æœŸæ—¥',
                'tableHeaderDeposit': 'æŠ¼é‡‘è¯¦æƒ…',
                
                // è´¢åŠ¡çŠ¶æ€
                'financeStatusSubtitle': 'è¯¦ç»†æŸ¥çœ‹æ”¶å…¥ã€æ”¯å‡ºã€å‡€ç°é‡‘æµå’Œå¹´åº¦é¢„ç®—æ‰§è¡Œæƒ…å†µã€‚',
                'monthlyIncomeTitle': 'æœ¬æœˆæ”¶å…¥', 'monthlyExpenseTitle': 'æœ¬æœˆæ”¯å‡º', 'netCashFlowTitle': 'æœ¬æœˆå‡€ç°é‡‘æµ',
                'incomeExpenseTrendTitle': 'æ”¶å…¥ä¸æ”¯å‡ºè¶‹åŠ¿ (è¿‡å» 12 ä¸ªæœˆ)',
                'exportFinancialButton': 'å¯¼å‡ºè´¢åŠ¡æŠ¥è¡¨',
                'detailedStatementTitle': 'è¯¦ç»†è´¢åŠ¡åˆ—è¡¨',
                'statementHint': 'ä¸‹æ–¹è¡¨æ ¼åŒ…å«æ”¶å…¥ã€æ”¯å‡ºå’Œåº”æ”¶è´¦æ¬¾ï¼ˆReceivableï¼‰çš„è¯¦ç»†äº¤æ˜“è®°å½•ã€‚',
                'tableHeaderDate': 'æ—¥æœŸ', 'tableHeaderDescription': 'æè¿°', 'tableHeaderType': 'ç±»å‹', 'tableHeaderAmount': 'é‡‘é¢ (RM)',
                'chartLabelTotalIncome': 'å¹´åº¦æ€»æ”¶å…¥', 'chartLabelTotalExpense': 'å¹´åº¦æ€»æ”¯å‡º',

                // ç»´æŠ¤ä¸æŠ•è¯‰
                'maintenanceSubtitle': 'è·Ÿè¸ªæ‰€æœ‰ç»´æŠ¤å’Œä¿®ç†è¯·æ±‚çš„çŠ¶æ€å’Œè¿›åº¦ã€‚',
                'openTicketsList': 'å¼€æ”¾å·¥å•åˆ—è¡¨ (å…± 7 ä¸ª)', 'newTicketButton': 'åˆ›å»ºæ–°å·¥å•',
                'ticketID': 'ID', 'ticketProperty': 'ç‰©ä¸š', 'ticketIssue': 'é—®é¢˜', 'ticketPriority': 'ä¼˜å…ˆçº§', 'ticketStatus': 'çŠ¶æ€', 'ticketCreated': 'åˆ›å»ºæ—¶é—´', 'ticketActions': 'æ“ä½œ',
                'issueLeak': 'æµ´å®¤æ¼æ°´', 'issueAC': 'ç©ºè°ƒä¸åˆ¶å†·', 'issueDoor': 'å§å®¤é—¨é”æ¾åŠ¨',
                'priorityHigh': 'é«˜', 'priorityMedium': 'ä¸­', 'priorityLow': 'ä½',
                'statusPending': 'å¾…ç¡®è®¤', 'statusAssigned': 'å·²åˆ†é…', 'statusResolved': 'å·²è§£å†³',
                
                // ç”¨æˆ·ç®¡ç†
                'userManagementSubtitle': 'ç®¡ç†ç³»ç»Ÿç”¨æˆ·åŠæˆæƒçº§åˆ«ã€‚ç®¡ç†å‘˜æ‹¥æœ‰æ·»åŠ ç”¨æˆ·æƒé™ã€‚',
                'userList': 'ç³»ç»Ÿç”¨æˆ·åˆ—è¡¨',
                'addNewUserButton': 'æ–°å¢ç”¨æˆ· (Admin)',
                'tableHeaderUser': 'ç”¨æˆ·å',
                'tableHeaderUserRole': 'è§’è‰²/æƒé™',
                'tableHeaderUserEmail': 'é‚®ç®±',
                'actionResetPW': 'é‡ç½®å¯†ç ',
            },
            'en': {
                'pageTitle': 'KeyHome Property Management System',
                'loginTitle': 'System Login',
                'usernameLabel': 'Username',
                'passwordLabel': 'Password',
                'loginButton': 'Login',
                'loginError': 'Incorrect username or password!',
                'logoutButton': 'Logout',

                'salesSummaryTitle': 'Sales Dashboard',
                'tenantsTitle': 'Tenant Management',
                'propertyListTitle': 'Property List',
                'landlordsTitle': 'Landlord Management',
                'financeStatusTitle': 'Financial Status',
                'maintenanceTitle': 'Maintenance & Complaint',
                'userManagementTitle': 'User Management',

                'roleAdmin': 'Super Admin (Admin)',
                'roleStaff': 'Staff',
                
                'summaryTotalProperties': 'Total Properties',
                'summaryRentCollected': 'Rent Collected (MTD)',
                'summaryVacancyRate': 'Current Vacancy Rate',
                'summaryExpiringLeases': 'Leases Expiring (30 days)',
                'MoM': 'MoM', 'YoY': 'YoY',

                // Charts Period (UPDATED per request)
                'chartPeriodM': 'M',
                'chartPeriodQ': 'S', // Season/Quarter
                'chartPeriodY': 'Y',

                'annualIncomeTrendTitle': 'Income & Expense Trend (RM)',
                'financeDistributionTitle': 'Rent Received vs. Receivable',
                'chartLabelIncome': 'Income', 'chartLabelExpense': 'Expense', 'chartLabelAmountThousandsRM': 'Amount (k RM)',
                'chartLabelReceived': 'Rent Received', 'chartLabelReceivable': 'Rent Receivable (Outstanding)',
                'urgentActionTitle': 'Urgent Actions & Alerts',
                'action1': 'ğŸ› ï¸ P003 (KLCC) Bathroom leak - **High Priority** ticket M011 awaiting vendor confirmation.',
                'action2': 'âš ï¸ Tenant John Smith (P003) Rent is **5 days overdue** (RM 2,550.00).',
                'action3': 'ğŸ”‘ P002 (PJ Sentral) Preparing property, viewing scheduled next week.',
                
                // Tenant Management (UPDATED)
                'tenantsSubtitle': 'Manage all tenant information, lease status, and contact details. Total Leases: 48.',
                'activeTenantsList': 'Active Tenants List',
                'exportDataButton': 'Export Data',
                '[placeholder]searchTenantPlaceholder': 'Filter by name, property ID, or status...',
                'filterAll': 'All Statuses', 'filterActive': 'Active', 'filterExpiring': 'Expiring', 'filterOverdue': 'Overdue',
                'tableHeaderTenant': 'Tenant', 'tableHeaderProperty': 'Property ID / Address', 'tableHeaderRent': 'Monthly Rent (RM)', 
                'tableHeaderPIC': 'Appointed PIC', // NEW
                'tableHeaderTenantRemark': 'Remark', // NEW
                'tableHeaderReferAgent': 'Refer Agent', // NEW
                'tableHeaderAgentContact': 'Agent Contact', // NEW
                'tableHeaderAgentCompany': 'Agent Company', // NEW
                'tableHeaderLeaseEnd': 'Lease End Date', 'tableHeaderStatus': 'Status', 'tableHeaderActions': 'Actions',
                'statusActive': 'Active', 'statusOverdue': 'Overdue (5 days)', 'statusExpiring': 'Expiring Soon',
                'actionContact': 'Contact', 'actionCollect': 'Collect Rent', 'actionRenew': 'Renew', 'actionEdit': 'Edit', // NEW
                'tableFooterHint': 'Click table headers to sort, use search bar for instant filtering.',

                // Property List
                'propertyListSubtitle': 'Manage details, status, and associated owners for all entrusted properties.',
                'addNewPropertyButton': 'Add New Property',
                '[placeholder]searchPropertyPlaceholder': 'Search by address or ID...',
                'filterAllLocations': 'All Locations (Group Filter)',
                'statusRented': 'Rented',
                'statusRenovation': 'Renovation',
                'statusPreparing': 'Preparing',
                'ownerLabel': 'Owner', 'tenantLabel': 'Tenant', 'rentDueLabel': 'Next Rent Due', 'leaseExpLabel': 'Lease Expiry', 'vacantSinceLabel': 'Vacant Since', 'noTenant': 'No Tenant',
                'picLabel': 'PIC', // NEW
                'actionViewDetails': 'View Details', 'actionScheduleViewing': 'Schedule Viewing', 'actionUrgentCall': 'Urgent Contact',
                'propAddress1': '201 Laman Cengal, KL', 'propAddress2': 'A-12-05 Sentral Tower, PJ', 'propAddress3': '15 Taman Impian, Puchong',

                // Landlord Management (UPDATED)
                'landlordsSubtitle': 'Manage details for all landlords and referring agents.',
                'landlordsList': 'Landlord Information List',
                'addNewLandlordButton': 'Add New Landlord',
                'tableHeaderOwner': 'Owner Name',
                'tableHeaderContact': 'Contact Details',
                'tableHeaderLocation': 'Main Property Location',
                'tableHeaderLandlordRemark': 'Owner Remark', // NEW
                'tableHeaderAgreementEnd': 'Agreement End Date',
                'tableHeaderDeposit': 'Deposit Details',
                
                // Financial Status
                'financeStatusSubtitle': 'View detailed income, expense, net cash flow, and annual budget execution.',
                'monthlyIncomeTitle': 'Monthly Income', 'monthlyExpenseTitle': 'Monthly Expense', 'netCashFlowTitle': 'Monthly Net Cash Flow',
                'incomeExpenseTrendTitle': 'Income & Expense Trend (Last 12 Months)',
                'exportFinancialButton': 'Export Financial Report',
                'detailedStatementTitle': 'Detailed Financial Statement',
                'statementHint': 'The table below includes detailed transaction records for Income, Expense, and Receivables.',
                'tableHeaderDate': 'Date', 'tableHeaderDescription': 'Description', 'tableHeaderType': 'Type', 'tableHeaderAmount': 'Amount (RM)',
                'chartLabelTotalIncome': 'Total Annual Income', 'chartLabelTotalExpense': 'Total Annual Expense',

                // Maintenance & Complaint
                'maintenanceSubtitle': 'Track the status and progress of all maintenance and repair requests.',
                'openTicketsList': 'Open Tickets List (Total 7)', 'newTicketButton': 'Create New Ticket',
                'ticketID': 'ID', 'ticketProperty': 'Property', 'ticketIssue': 'Issue', 'ticketPriority': 'Priority', 'ticketStatus': 'Status', 'ticketCreated': 'Created On', 'ticketActions': 'Actions',
                'issueLeak': 'Bathroom Leak', 'issueAC': 'AC Not Cooling', 'issueDoor': 'Bedroom Lock Loose',
                'priorityHigh': 'High', 'priorityMedium': 'Medium', 'priorityLow': 'Low',
                'statusPending': 'Pending Confirmation', 'statusAssigned': 'Assigned', 'statusResolved': 'Resolved',

                // User Management
                'userManagementSubtitle': 'Manage system users and authorization levels. Admins have the right to add users.',
                'userList': 'System User List',
                'addNewUserButton': 'Add New User (Admin)',
                'tableHeaderUser': 'Username',
                'tableHeaderUserRole': 'Role/Permission',
                'tableHeaderUserEmail': 'Email',
                'actionResetPW': 'Reset Password',
                'actionEdit': 'Edit',
            }
        };

        let currentLang = localStorage.getItem('currentLang') || 'zh';

        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('currentLang', lang); // Save preference
            document.getElementById('current-lang-text').innerText = lang === 'zh' ? 'ä¸­æ–‡' : 'English';
            updateContent();
        }

        function updateContent() {
            const currentTranslation = translations[currentLang];
            
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                
                if (key.startsWith('[placeholder]')) {
                    const actualKey = key.substring(13); 
                    if (currentTranslation[actualKey]) {
                        element.setAttribute('placeholder', currentTranslation[actualKey]);
                    }
                } else if (currentTranslation[key]) {
                    element.innerText = currentTranslation[key];
                }
            });

            // Re-draw charts to update labels (only if logged in)
            if (localStorage.getItem('loggedIn') === 'true') {
                drawAllCharts(currentTranslation);
            }
        }

        // --- äº‹ä»¶ç›‘å¬å’Œåˆå§‹åŒ– ---
        document.addEventListener('DOMContentLoaded', () => {
            setLanguage(currentLang);
            
            // Check login status and show appropriate interface
            checkLogin();
            
            // Trend chart period switch event listener
            document.querySelectorAll('[data-chart-period]').forEach(button => {
                button.addEventListener('click', function() {
                    document.querySelectorAll('[data-chart-period]').forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    currentChartPeriod = this.getAttribute('data-chart-period');
                    drawAllCharts(translations[currentLang]);
                });
            });
            
            // Initial filter for property cards
            filterPropertyCards();
            filterLandlordTable();
        });
    </script>

</body>
</html>